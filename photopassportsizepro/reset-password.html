<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Update Password</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<link href="https://fonts.googleapis.com/css?family=Inter:400,600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
/* ... same styles as before ... */
</style>
</head>

<body>

<div class="auth-container">

    <i class="fa fa-lock" style="font-size:44px;color:#667eea;"></i>
    <h2>Update Password</h2>
    <p>Enter your new password below</p>

    <form id="update-password-form">
        <input type="password" id="new-password" placeholder="New password" required minlength="6">
        <input type="password" id="confirm-password" placeholder="Confirm password" required minlength="6">

        <button class="submit-btn">Update Password</button>

        <div id="update-status" class="status-message"></div>
    </form>

    <p style="margin-top:15px;">
        <a href="login.html" style="color:#667eea;">Back to Login</a>
    </p>
</div>

<script>
const SUPABASE_URL = "https://wtryahnysabnjdcypihl.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind0cnlhaG55c2FibmpkY3lwaWhsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxMTM0NTAsImV4cCI6MjA3NzY4OTQ1MH0.uLi6Nfk8NQ9KmR_Igt9sb_wtQxtujm_lipT6TU3dwjM";

const client = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

function showStatus(msg, error=false){
    const el=document.getElementById("update-status");
    el.textContent=msg;
    el.className=`status-message show ${error?"error":"success"}`;
}

/* UPDATE PASSWORD */
document.getElementById("update-password-form").addEventListener("submit", async (e)=>{
    e.preventDefault();

    const pass = document.getElementById("new-password").value;
    const confirm = document.getElementById("confirm-password").value;

    if(pass !== confirm) return showStatus("Passwords do not match!",true);

    const { error } = await client.auth.updateUser({ password: pass });

    if(error) return showStatus(error.message,true);

    showStatus("Password updated! Redirecting...");
    setTimeout(()=>location.href="login.html",1500);
});
</script>

</body>
</html>
